# package.json updates

Apply these changes to the `package.json` generated by `nest new`. Do not regenerate the file from scratch — patch only the fields shown.

## 1. Replace the `scripts` block

Remove all existing scripts and replace with:

```json
"scripts": {
  "postinstall": "lefthook install",
  "build": "nest build",
  "format": "biome format --write src/",
  "start": "nest start",
  "start:dev": "nest start --watch",
  "start:debug": "nest start --debug --watch",
  "start:prod": "node dist/main",
  "lint": "biome check --write src/",
  "check": "biome check src/",
  "test": "vitest run",
  "test:unit": "vitest run --project unit",
  "test:int": "vitest run --project integration",
  "test:e2e": "vitest run --project e2e",
  "test:watch": "vitest",
  "test:watch:unit": "vitest --project unit",
  "test:cov": "vitest run --coverage",
  "db:migrate": "prisma migrate dev",
  "db:migrate:prod": "prisma migrate deploy",
  "db:studio": "prisma studio",
  "db:generate": "prisma generate",
  "db:reset": "prisma migrate reset --force"
}
```

### Script reference

| Script | Behavior |
|--------|----------|
| `lint` | Auto-fix all Biome issues in `src/` (replaces `eslint --fix`) |
| `format` | Auto-format `src/` without running lint rules |
| `check` | Read-only Biome check — no writes; use in CI |
| `postinstall` | Installs lefthook git hooks on `pnpm install` |

### Test command reference

| Command | Runs |
|---------|------|
| `pnpm test` | All tests (unit + integration + e2e via workspace) |
| `pnpm test:unit` | `*.spec.ts` only (excludes `*.integration.spec.ts` and `*.e2e.spec.ts`) |
| `pnpm test:int` | `*.integration.spec.ts` only |
| `pnpm test:e2e` | `*.e2e.spec.ts` only |
| `pnpm test:watch` | All tests in watch mode |
| `pnpm test:watch:unit` | Unit tests in watch mode |
| `pnpm test:cov` | All tests with coverage report |

## 2. Remove the `jest` top-level config block

Delete the entire top-level `jest` key and its value from `package.json`. It typically looks like:

```json
"jest": {
  "moduleFileExtensions": ["js", "json", "ts"],
  "rootDir": "src",
  "testRegex": ".*\\.spec\\.ts$",
  "transform": { "^.+\\.(t|j)s$": "ts-jest" },
  "collectCoverageFrom": ["**/*.(t|j)s"],
  "coverageDirectory": "../coverage",
  "testEnvironment": "node"
}
```

Remove this block entirely. Vitest is configured via `vitest.config.ts` and `vitest.workspace.ts`.

## 3. Verify removed packages are absent from `devDependencies`

The `pnpm remove` command in step 5 handles this. Confirm these keys are absent:

**Jest:**
- `jest`, `@types/jest`, `ts-jest`, `supertest`, `@types/supertest`

**Express:**
- `@nestjs/platform-express`

**ESLint / Prettier:**
- `eslint`, `@typescript-eslint/eslint-plugin`, `@typescript-eslint/parser`
- `eslint-config-prettier`, `eslint-plugin-prettier`, `prettier`, `@nestjs/eslint-plugin`

## Result

After applying these changes, `package.json` should have:
- Scripts exactly as shown in section 1
- No `jest` block at the top level
- No Jest, Express, ESLint, or Prettier entries in `devDependencies`
